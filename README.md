# Multiple-Linear-Regression-Project

### Context
As part of my coursework at Stony Brook University, I was required to perform data analysis involving multiple linear regression models. Here is one such project that demonstrates me making a multiple linear regression model based on a data set and analyzing said model. Please take a look below at my report!

### Objective 

For this project, I was given a data file that contained 1335 observations of 25
variables. Of the 25 variables, one was a dependent variable (Y), and twenty-four were
independent variables of which four were environmental variables (E1-E4) and twenty were
genetic risk variables that were indicator variables with values of 0 and 1 (G1-G20). The
goal/background of this assignment was to use the data given to find the original model that had been used to produce the data. This means finding out what independent variables significantly effect Y and what interactions between these independent variables significantly effect Y in order to build the final model that had produced this data. I then have to estimate the coefficients associated with said model and use them to make an estimate of said model. 

### Data Source

Dataset Used: https://github.com/darianlee555/Multiple-Linear-Regression-Project/blob/main/Project2File.csv

### Methods
**ALL CODE USED CAN BE FOUND IN THE R CODE APPENDIX SECTION BELOW**

I used R throughout this entire project. First, I found the number of observations using the read() function which gave me 1335 observations of 25 variables as mentioned earlier. I then checked for missing data using the mice library and md.pattern() function and R reported to me that there was no missing data, so this wasn’t a problem I had to worry about in my analysis. I then made a linear model relating Y to just the environment variables (E1-E4) to see if this model of solely environmental variables with no genetic risk variables or interactions was the correct final model that had produced this data. I then saw if adding the genetic risk variables (G1-G20) to the model of environmental variables made a better model for describing the data.

For this model of both environmental and genetic risk variables, I assumed that there were only 2nd order interactions, but I later check for 3rd order interactions in variables that I believed were optimal candidates to be included in the final model. I then used the MASS library and boxcox() function on the linear model of both environmental and genetic risk variables to see if a transformation of Y was needed to have a patternless residual plot and have the data follow more of a normal distribution. The boxcox() function gave me a 95% C.I. for lambda that was approximately around 0.8-1.2 with an estimated lambda value of 1, so because of the narrowness of the 95% C.I. and the estimated lambda value of 1, this highly indicates to me that no transformation is needed, and this makes sense as the residual plot looks relatively clustered and patternless and the given data is already relatively normally distributed which is ideal, indicating that no transformation of Y is needed. Also, any transformation for Y that I tried, it only resulted in a worse residual plot that had a clear pattern and/or the transformation made the given data less normally distributed and more skewed which is not ideal. So, this is further support that no transformation for Y is needed. Forward stepwise regression was then done using the leaps library and regsubsets() function, where I used Bayesian information criterion (BIC) values and adjusted r<sup>2</sup> 
values as criteria of which variables and interactions to include that would significantly affect Y. So, forward stepwise regression had given me several possible models, one of which is likely to be the final model that was used to generate the data or at least have the variables that are likely to be included in the final model that I can select as candidates for more analysis. 

After careful consideration and comparison of the models, I believe that the 3rd model that was given to me which was Y = (Intercept)+E1+E2:E3+E4:G5 is the best model out of the five given to further analyze. I say this because both the adjusted r<sup>2</sup> value does not significantly increase and the BIC value does not significantly decrease between the 3rd and 4th models listed from forward stepwise regression, so I believe that 3rd model is the most deserving of further analysis and the variables included are very likely to be part of the final model. Also, it is unwise to include more parameters into a model (4th and 5th model has more parameters) for such minute changes in adjusted r<sup>2</sup>  and BIC values as it would increase the probability of making a Type I error via Bonferroni’s inequality. So, I select E1, E2, E3, E4, and G5 as candidate variables for my final model. I will analyze if these variables are significant and if any interactions between these candidate variables are significant enough to be included like how the 3rd model given by forward stepwise regression indicates. 

I can check for significance by analyzing the model of all the environmental and genetic risk variables and seeing what variables and what interactions are significant in said model (where I measure that a main effect is significant if the associated pvalue for that variable is less than 0.001). I saw that significant main effects were E1, E2, E3, E4, G5, all with p-values of 0 (except for E4, but E4 still has a very low p-value) and t-values well over 4 (except for E4 which is barely below 4, but if one sets a significant t-value at over 3.5 instead, one would consider E4 significant, indicating to me that E4 is significant). So, this tells me that E1, E2, E3, E4, and G5 is very likely to be included in my final model since these are all significant main effects. I then analyzed second-order interactions in the model of both the environmental and genetic risk variables and saw what second-order interactions were considered significant (where I measure that a second-order interaction is significant if the associated p-value for that second-order interaction is less than 0.001). 

I saw that the significant second order interactions are E4:G5 and G16:G18 with E4:G5 having an t-value over 4 and practically 0 p-value and G16:G18 having an t-value not over 4, but over 3.5 and a very small pvalue. However, G16:G18 is not included in the 3rd model I got from forward stepwise regression, so I’ve determined it does not play a significant role in the final model I.E. it doesn’t affect Y significantly so I can just exclude G16:G18 in my final model. Also, the adjusted r<sup>2</sup>  values and the BIC value when G16:G18 is included in the model have such little difference compared to the r<sup>2</sup> 
value and the BIC value when G16:G18 is excluded from the model, indicating to me that it doesn’t significantly effect Y and is unwise to include in my final model. E4:G5 being significant indicates to me that E4 being listed as significant was not an error and that E4 does indeed serve as a significant main effect related to Y. And since E4 and G5 are significant main effects and the E4:G5 interaction is significant, I must now see whether it is wise to include the E4:G5 interaction as part of our final model or if a model of simply significant main effects is better which I will do later. For now, since I have checked for
significant main effects and significant second-order interactions, I must lastly check for significant third-order interactions within the candidate variables I have selected (where I
measure that a third-order interaction is significant if the associated p-value for that third-order interaction is less than 0.001). I found that there were no significant third-order interactions, so this was not something I needed to worry about as being a part of my final model. 

Ok, so after checking for significant main effects, significant second-order interactions, and significant third-order interactions, I saw that the most important variables to use were E1, E2, E3, E4, G5 as these were the significant main effects with the decision to include the interactions E4:G5 and E2:E3 needing further analysis. Ultimately, to see whether E2:E3 and E4:G5 plays a significant role in my final model, I must see whether a model of simply significant main effects was better than the listed 3rd model given to me from forward stepwise regression. Making test models where one model consists just of significant main effects and the other model is the 3rd model given to me by forward stepwise regression for the sake of comparison I.E. comparing Y= 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝛽5𝐺5 + 𝜖 to Y = 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2: 𝐸3 + 𝛽3𝐸4: 𝐺5 + 𝜖. I analyzed these two models to see which one more accurately describes the data. Using the summary function on both models, I saw that the adjusted r<sup>2</sup> value for Y= 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝛽5𝐺5 + 𝜖 is 0.5559 while the adjusted r<sup>2</sup> value for Y = 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2:𝐸3 + 𝛽3𝐸4:𝐺5 + 𝜖 is 0.5647 (less than 1% difference). The residual plots and density plots associated with said models look nearly identical as well. This tells me that the interactions of E2:E3 and E4:G5 do not significantly contribute to Y any more than the significant main effects do. Thus, since in statistics, its better to have a simpler model of just significant main effects then a complex model with interactions if there is no meaningful difference between the two, I believe that the model of significant main effects is the better of the two and so, I state that the final model that was used to generate this data is: Y= 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝛽5𝐺5 + 𝜖. Using the summary() function to generate the coefficients associated with said model to estimate said model, I get 𝛽0 = 22.4559, 𝛽1 = 5.2817, 𝛽2 = 8.4961, 𝛽3 = 8.5514, 𝛽4 = 2.6919, and 𝛽5 = 79.7722. So, the estimated model would be E(Y) = 22.4559 + 5.2817E1 + 8.4961E2 + 8.5514E3 + 2.6919E4 + 79.7722G5.

### Results
**ALL CODE USED TO OBTAIN THESE RESULTS CAN BE FOUND IN THE R CODE APPENDIX SECTION BELOW**

When I made a model of solely environmental variables, it did not accurately describe the data well since it has a very low r<sup>2</sup> compared to the model where I added the genetic risk variables, indicating to me that a model of solely environmental variables is a very unwise choice for my final model. As for the variables that I believe are associated with Y, I believe that the significant main effect variables (E1-E4 and G5) are associated with Y and that interactions between the independent variables (notably, E4:G5 and E2:E3) do not effect Y any more than these significant main effect variables already do. Thus, I believe that the final model that was used to obtain the data given to me is simply the model of significant main effects: Y= 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝛽5𝐺5 + 𝜖. The estimate of said model is E(Y) = 22.4559 + 5.2817E1 + 8.4961E2 + 8.5514E3 + 2.6919E4 + 79.7722G5. The residual plot and the density plot and the table of coefficients associated with the final model that I used to get the estimates of the coefficients is shown in the appendix. 

### Discussions and Conclusions
The goal of this project was to find the final model that was used to generate the data given to me. To do this, I looked at significant coefficients, significant second order interactions, and significant third order interactions and narrowed the number of possible models down to 3 models. Model 1 was just a model of solely environmental variables (Y = 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝜖), model 2 was a model of the significant main effects (Y= 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝛽5𝐺5 + 𝜖), and model 3 was the third model given to me by forward stepwise regression (Y = 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2:𝐸3 + 𝛽3𝐸4:𝐺5 + 𝜖). After
comparing all three models, I believe that model 2: Y= 𝛽0 + 𝛽1𝐸1 + 𝛽2𝐸2 + 𝛽3𝐸3 + 𝛽4𝐸4 + 𝛽5𝐺5 + 𝜖 was best since a model of solely environmental variables did not accurately describe the data well since it has a very low  value compared to the model where I added the genetic risk variables, indicating that genetic risk variables are very likely to be part of my final model and a model of solely environmental variables does not describe my data well at all. To be more specific, the r<sup>2</sup> value I got for the model of both environmental and genetic risk variables was 0.5725 which is a vast improvement from the r<sup>2</sup> value of 0.1274 I got from solely environmental variables which means that adding the genetic risk variables significantly improves the model of solely environmental variables. So, it seems very likely that genetic risk variables will be a part of the final model that was used to generate this data and a model of solely environmental variables isn’t a very accurate final model at all. 

Thus, I should consider both environmental and genetic risk variables as part of my final model and deem the model of solely environmental variables as inadequate. So, model 1 is out of the picture for possible final models. The model of significant main effects (model 2) compared to the model with interactions (model 3) had a very minute difference in r<sup>2</sup> values as model 2 had a adjusted r<sup>2</sup> value of 0.5559 and model 3 had an adjusted r<sup>2</sup> value of 0.5647 (less then 1% difference) and the two models have nearly identical density plots and residual plots, indicating that the interactions E2:E3 and E4:G5 did not significantly effect Y anymore then the model of main effects, and so this tells me to just use the significant main effects model, as simpler models without interactions are better in statistics if there’s no real difference between the two models. So, estimating the model of significant main effects I get, E(Y) = 22.4559 + 5.2817E1 + 8.4961E2 + 8.5514E3 + 2.6919E4 + 79.7722G5. The residual plot and density plot in the appendix section show that when I use this model, I get a patternless and clustered residual plot and the data follows an almost completely normal distribution causing me to believe that this model of significant main effects is correct. The table of coefficients of the model in the results section also support this model choice as the variables in the model all have t-values over 4 and p-values = 0 strongly indicating that they belong in the final model. So, I conclude that E(Y) = 22.4559 + 5.2817E1 + 8.4961E2 + 8.5514E3 + 2.6919E4 + 79.7722G5 is what was used to generate my data.

### R Code Appendix
You can find the code I used along with tables, plots, and other graphics here: https://github.com/darianlee555/Multiple-Linear-Regression-Project/blob/main/Project-2-Code.pdf
